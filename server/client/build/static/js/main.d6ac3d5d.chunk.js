(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{22:function(e,t,a){e.exports=a(34)},27:function(e,t,a){},28:function(e,t,a){},34:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(20),s=a.n(c),l=(a(27),a(5)),o=(a(28),a(6)),i=function(){var e=Object(n.useContext)(P),t=e.state,a=e.dispatch;return r.a.createElement("nav",null,r.a.createElement("div",{className:"nav-wrapper white"},r.a.createElement(o.b,{to:t?"/":"/signin",className:"brand-logo left",style:{paddingLeft:"10px"}},"Instagram"),r.a.createElement("ul",{id:"nav-mobile",className:"right"},(console.log(t),t?[r.a.createElement("li",null,r.a.createElement(o.b,{to:"/"},"Home")),r.a.createElement("li",null,r.a.createElement(o.b,{to:"/profile"},"Profile")),r.a.createElement("li",null,r.a.createElement(o.b,{to:"/create"},"Create Post")),r.a.createElement("li",null,r.a.createElement("button",{className:"btn #c62828 red darken-3",onClick:function(){localStorage.clear(),a({type:"CLEAR"})}},"Logout"))]:[r.a.createElement("li",null,r.a.createElement(o.b,{to:"/signin"},"Login")),r.a.createElement("li",null,r.a.createElement(o.b,{to:"/signup"},"Sign Up"))]))))},u=a(2),p=a(1),m=a.n(p),d=a(3),f=a(7),h={credentials:"same-origin"};function b(e,t){var a,n="";return"object"==typeof t&&t&&(n="?"+(a=t,Object.keys(a).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(a[e])})).join("&"))),e+n}function E(e){return v.apply(this,arguments)}function v(){return(v=Object(d.a)(m.a.mark((function e(t){var a,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.status>=400)){e.next=19;break}return a=null,e.prev=2,e.next=5,t.json();case 5:a=e.sent,e.next=10;break;case 8:e.prev=8,e.t0=e.catch(2);case 10:if(!a){e.next=16;break}if(!a.errorCode){e.next=14;break}e.next=16;break;case 14:if(!a.error){e.next=16;break}throw new Error(a.error);case 16:if(!(n=t.headers.get("error"))){e.next=19;break}throw new Error(n);case 19:return e.abrupt("return",t);case 20:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}function g(e){return y.apply(this,arguments)}function y(){return(y=Object(d.a)(m.a.mark((function e(t){var a,n,r,c,s,l=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.length>1&&void 0!==l[1]?l[1]:{},n=l.length>2&&void 0!==l[2]?l[2]:{},r=Object(f.a)(Object(f.a)({method:"GET"},a),{},{headers:Object(f.a)({},a.headers)}),(c=localStorage.getItem("jwt"))&&(r.headers.Authorization="Bearer ".concat(c)),e.prev=5,e.next=8,fetch(b(t,a&&a.query),r);case 8:return s=E(s=e.sent),n.checkResponse&&n.checkResponse(s),e.abrupt("return",s);case 14:throw e.prev=14,e.t0=e.catch(5),e.t0.response||(e.t0.message="Check connection."),e.t0;case 18:case"end":return e.stop()}}),e,null,[[5,14]])})))).apply(this,arguments)}function j(e,t){return g(e,Object(f.a)(Object(f.a)({},h),{},{headers:{Accept:"application/json"}}),t).then((function(e){return e.json()}))}function x(e,t,a){return g(e,Object(f.a)(Object(f.a)({},h),{},{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(t,null,2)}),a).then((function(e){return e.json()}))}function O(e,t,a){return g(e,Object(f.a)(Object(f.a)({},h),{},{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(t,null,2)}),a).then((function(e){return e.json()}))}function w(e,t){return g(e,Object(f.a)(Object(f.a)({},h),{},{method:"DELETE",headers:{}}),t).then((function(e){return e.json()}))}var k=a(8),C=a.n(k),N=function(){var e=Object(n.useState)([]),t=Object(l.a)(e,2),a=t[0],c=t[1],s=Object(n.useContext)(P),o=s.state;s.dispatch;function i(){return(i=Object(d.a)(m.a.mark((function e(t){var n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O("/like",{postId:t});case 2:n=e.sent,r=a.map((function(e){return e._id==n._id?n:e})),c(r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(){return(u=Object(d.a)(m.a.mark((function e(t){var n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O("/unlike",{postId:t});case 2:n=e.sent,console.log(n),r=a.map((function(e){return e._id==n._id?n:e})),c(r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(){return(p=Object(d.a)(m.a.mark((function e(t,n){var r,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O("/comment",{text:t,postId:n});case 2:r=e.sent,console.log(r),s=a.map((function(e){return e._id==r._id?r:e})),c(s);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(){return(f=Object(d.a)(m.a.mark((function e(t){var n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("/deletepost/".concat(t));case 2:n=e.sent,r=a.filter((function(e){return e._id!=n._id})),c(r),C.a.toast({html:n,classes:"#43a047 green darken-1"});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){Object(d.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j("/allpost");case 2:t=e.sent,c(t.posts);case 4:case"end":return e.stop()}}),e)})))()}),[]),r.a.createElement("div",{className:"home"},a.map((function(e){return r.a.createElement("div",{className:"card home-card",key:e._id},r.a.createElement("h5",null,e.postedBy.name,e.postedBy._id==o._id&&r.a.createElement("i",{className:"material-icons",style:{float:"right",color:"red"},onClick:function(){!function(e){f.apply(this,arguments)}(e._id)}},"delete")),r.a.createElement("div",{className:"card-image"},r.a.createElement("img",{src:e.photo})),r.a.createElement("div",{className:"card-content"},e.likes.includes(o._id)?r.a.createElement("i",{className:"material-icons",style:{color:"grey"},onClick:function(){!function(e){u.apply(this,arguments)}(e._id)}},"thumb_down"):r.a.createElement("i",{className:"material-icons",style:{color:"blue"},onClick:function(){!function(e){i.apply(this,arguments)}(e._id)}},"thumb_up"),r.a.createElement("h6",null,e.likes.length," likes "),r.a.createElement("h6",null,e.title),r.a.createElement("p",null,e.body),e.comments.map((function(e){return r.a.createElement("h6",{key:e._id},r.a.createElement("span",{style:{fontWeight:"500"}},e.postedBy.name,": ",e.text))})),r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),function(e,t){p.apply(this,arguments)}(t.target.comment.value,e._id)}},r.a.createElement("input",{type:"text",id:"comment",placeholder:"Add a comment"}))))})))},S=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,_=function(){var e=Object(u.f)(),t=Object(n.useState)(""),a=Object(l.a)(t,2),c=a[0],s=a[1],i=Object(n.useState)(""),p=Object(l.a)(i,2),f=p[0],h=p[1],b=Object(n.useContext)(P).dispatch;function E(){return v.apply(this,arguments)}function v(){return(v=Object(d.a)(m.a.mark((function t(){var a;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(S.test(f)){t.next=3;break}return C.a.toast({html:"Invalid email",classes:"#c62828 red darken-3"}),t.abrupt("return");case 3:return t.next=5,x("/signin",{email:f,password:c});case 5:(a=t.sent).err?C.a.toast({html:a.err,classes:"#c62828 red darken-3"}):(localStorage.setItem("jwt",a.token),localStorage.setItem("user",JSON.stringify(a.user)),b({type:"USER",payload:a.user}),C.a.toast({html:"Login successfull.",classes:"#43a047 green darken-1"}),e.push("/"));case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return r.a.createElement("div",{className:"my-card"},r.a.createElement("div",{className:"card auth-card input-field"},r.a.createElement("h2",null,"Instagram"),r.a.createElement("input",{type:"text",placeholder:"E-mail",value:f,onChange:function(e){return h(e.target.value)}}),r.a.createElement("input",{type:"password",placeholder:"Password",value:c,onChange:function(e){return s(e.target.value)}}),r.a.createElement("button",{className:"btn waves-effect waves-light #64b5f6 blue darken-1",onClick:Object(d.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E();case 2:case"end":return e.stop()}}),e)})))},"Login"),r.a.createElement("h5",null,r.a.createElement(o.b,{to:"/signup"},"Don't have an account?"))))},I=function(){var e=Object(n.useState)([]),t=Object(l.a)(e,2),a=t[0],c=t[1],s=Object(n.useContext)(P),o=s.state;s.dispatch;return Object(n.useEffect)((function(){function e(){return(e=Object(d.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j("/mypost");case 2:t=e.sent,c(t.posts);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()})),r.a.createElement("div",{style:{maxWidth:"80%",margin:"0px auto"}},r.a.createElement("div",{style:{display:"flex",justifyContent:"space-around",margin:"18px 0px",borderBottom:"1px solid grey"}},r.a.createElement("div",null,r.a.createElement("img",{style:{width:"160px",height:"160px",borderRadius:"80px"},src:"https://images.unsplash.com/photo-1588288335249-314f506ee38c?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=800&q=80"})),r.a.createElement("div",null,r.a.createElement("h4",null," ",o?o.name:""),r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",margin:"18px 0px",width:"108%"}},r.a.createElement("h6",null,"40 posts"),r.a.createElement("h6",null,"456 followers"),r.a.createElement("h6",null,"134 following")))),r.a.createElement("div",{className:"gallery"},a.map((function(e){return r.a.createElement("img",{id:e._id,className:"item",src:e.photo,alt:e.title})}))))},A=function(){var e=Object(u.f)(),t=Object(n.useState)(""),a=Object(l.a)(t,2),c=a[0],s=a[1],i=Object(n.useState)(""),p=Object(l.a)(i,2),f=p[0],h=p[1],b=Object(n.useState)(""),E=Object(l.a)(b,2),v=E[0],g=E[1];function y(){return j.apply(this,arguments)}function j(){return(j=Object(d.a)(m.a.mark((function t(){var a;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(S.test(v)){t.next=3;break}return C.a.toast({html:"Invalid email",classes:"#c62828 red darken-3"}),t.abrupt("return");case 3:return t.next=5,x("/signup",{name:c,email:v,password:f});case 5:(a=t.sent).err?C.a.toast({html:a.err,classes:"#c62828 red darken-3"}):(C.a.toast({html:a.message,classes:"#43a047 green darken-1"}),e.push("/signin"));case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return r.a.createElement("div",{className:"my-card"},r.a.createElement("div",{className:"card auth-card input-field"},r.a.createElement("h2",null,"Instagram"),r.a.createElement("input",{type:"text",placeholder:"Name",value:c,onChange:function(e){return s(e.target.value)}}),r.a.createElement("input",{type:"text",placeholder:"E-mail",value:v,onChange:function(e){return g(e.target.value)}}),r.a.createElement("input",{type:"password",placeholder:"Password",value:f,onChange:function(e){return h(e.target.value)}}),r.a.createElement("button",{onClick:Object(d.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:case"end":return e.stop()}}),e)}))),className:"btn waves-effect waves-light #64b5f6 blue darken-1"},"Sign Up"),r.a.createElement("h5",null,r.a.createElement(o.b,{to:"/signin"},"Already have an account?"))))},R=function(){var e=Object(u.f)(),t=Object(n.useState)(""),a=Object(l.a)(t,2),c=a[0],s=a[1],o=Object(n.useState)(""),i=Object(l.a)(o,2),p=i[0],f=i[1],h=Object(n.useState)(""),b=Object(l.a)(h,2),E=b[0],v=b[1],g=Object(n.useState)(""),y=Object(l.a)(g,2),j=y[0],O=y[1];function w(){return k.apply(this,arguments)}function k(){return(k=Object(d.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=new FormData).append("file",E),t.append("upload_preset","insta-clone"),t.append("cloud_name","dcooom6tq"),fetch("https://api.cloudinary.com/v1_1/dcooom6tq/image/upload",{method:"post",body:t}).then((function(e){return e.json()})).then((function(e){return O(e.url)})).catch((function(e){return console.log(e)}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){if(j){function t(){return(t=Object(d.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x("/createpost",{title:c,body:p,url:j});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var a=function(){return t.apply(this,arguments)}();a.error?C.a.toast({html:a.error,classes:"#c62828 red darken-3"}):(C.a.toast({html:"Post created successfully.",classes:"#43a047 green darken-1"}),e.push("/"))}}),[j]),r.a.createElement("div",{className:"card input-field",style:{margin:"30px auto",maxWidth:"500px",padding:"20px",textAlign:"center"}},r.a.createElement("input",{type:"text",placeholder:"Title",value:c,onChange:function(e){return s(e.target.value)}}),r.a.createElement("input",{type:"text",placeholder:"Body",onChange:function(e){return f(e.target.value)},value:p}),r.a.createElement("div",{className:"file-field input-field"},r.a.createElement("div",{className:"btn  #64b5f6 blue darken-1"},r.a.createElement("span",null,"Upload Image"),r.a.createElement("input",{type:"file",onChange:function(e){return v(e.target.files[0])}})),r.a.createElement("div",{className:"file-path-wrapper"},r.a.createElement("input",{className:"file-path validate",type:"text"}))),r.a.createElement("button",{className:"btn waves-effect waves-light #64b5f6 blue darken-1",onClick:Object(d.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:case"end":return e.stop()}}),e)})))},"Submit Post"))},B=function(e,t){return"USER"==t.type?t.payload:"CLEAR"==t.type?null:e},P=Object(n.createContext)(),U=function(){var e=Object(u.f)(),t=Object(n.useContext)(P).dispatch;return Object(n.useEffect)((function(){var a=JSON.parse(localStorage.getItem("user"));a?t({type:"USER",payload:a}):e.push("/signin")}),[]),r.a.createElement(u.c,null,r.a.createElement(u.a,{exact:!0,path:"/"},r.a.createElement(N,null)),r.a.createElement(u.a,{path:"/profile"},r.a.createElement(I,null)),r.a.createElement(u.a,{path:"/signin"},r.a.createElement(_,null)),r.a.createElement(u.a,{path:"/signup"},r.a.createElement(A,null)),r.a.createElement(u.a,{path:"/create"},r.a.createElement(R,null)))};var L=function(){var e=Object(n.useReducer)(B,null),t=Object(l.a)(e,2),a=t[0],c=t[1];return r.a.createElement(P.Provider,{value:{state:a,dispatch:c}},r.a.createElement(o.a,null,r.a.createElement(i,null),r.a.createElement(U,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(L,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[22,1,2]]]);
//# sourceMappingURL=main.d6ac3d5d.chunk.js.map